'use strict';

var fcc = 'free code camp';
(function (fcc) {
  //timer
  var display = document.querySelector('.time'),
      displayBreak = document.querySelector('.break-time');
  // define function for setInterval
  function getSeconds(hour) {
    var min = hour.textContent.split(':');
    return parseInt(min[0], 10) * 60;
  }
  // define function for setInterval
  function circularLoop(init, min, action) {
    var current = init;
    return function () {
      action(current);
      if (current - 1 === min) {
        current = min;
      } else if (current > 0) {
        current--;
      }
    };
  }
  var anim = void 0;
  var watch = function watch(display) {
    var seconds = void 0,
        minutes = void 0;
    anim = setInterval(circularLoop(getSeconds(display), 0, function (currSecond) {
      //parseInt() return integer ex 110/ 60 = 1.83333 with parseInt it's 1
      //I'm using Math.floor, both do the same work
      minutes = parseInt(currSecond / 60, 10);
      // seconds = 122s / 60 = 120 and remain 2
      seconds = parseInt(currSecond % 60, 10);

      //print a 0 first if minuste is less than 10 minutes 
      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;
      display.textContent = minutes + ":" + seconds;

      if (currSecond === 0) {
        clearInterval(anim);
      }
    }), 1000);
  };
  //END TIMER

  //Event + and -
  //
  var sessionPlus = document.querySelector('.session__plus'),
      sessionMinus = document.querySelector('.session__minus'),
      breakPlus = document.querySelector('.break__plus'),
      breakMinus = document.querySelector('.break__minus'),
      time = document.querySelector('.time'),
      breakTime = document.querySelector('.break-time'),
      play = document.querySelector('.play'),
      stop = document.querySelector('.icon-stop'),
      pause = document.querySelector('.pause');

  function previousMinus(e) {
    var prev = this.previousSibling,
        val = parseInt(prev.textContent, 10);
    if (val > 0) {
      prev.textContent--;
      if (val === 1) {
        prev.classList.add('alert');
      }
    }
    if (!this.classList.contains('break__minus')) {
      time.textContent = prev.textContent + ':00';
      clearInterval(anim);
    } else {
      breakTime.textContent = prev.textContent + ':00';
    }

    play.classList.add('show');
    play.classList.remove('hide');
    pause.classList.add('hide');
    pause.classList.remove('show');
    stop.classList.remove('show');
    stop.classList.add('hide');

    e.preventDefault();
  }
  function nextPlus(e) {
    var next = this.nextSibling;
    var val = parseInt(next.textContent, 10);
    next.textContent++;
    if (val === 0) {
      next.classList.remove('alert');
    }
    if (!this.classList.contains('break__plus')) {
      time.textContent = next.textContent + ':00';
      clearInterval(anim);
    } else {
      breakTime.textContent = next.textContent + ':00';
    }
    play.classList.add('show');
    play.classList.remove('hide');
    pause.classList.add('hide');
    pause.classList.remove('show');
    stop.classList.remove('show');
    stop.classList.add('hide');
    e.preventDefault();
  }

  sessionMinus.addEventListener('click', previousMinus);
  sessionPlus.addEventListener('click', nextPlus);
  breakMinus.addEventListener('click', previousMinus);
  breakPlus.addEventListener('click', nextPlus);
  play.addEventListener('click', playPodomoro);
  pause.addEventListener('click', pausePodomoro);
  stop.addEventListener('click', stopPodomoro);

  function playPodomoro(e) {
    watch(display);
    play.classList.add('hide');
    play.classList.remove('show');
    pause.classList.add('show');
    pause.classList.remove('hide');
    stop.classList.remove('hide');
    stop.classList.add('show');
    stop.classList.remove('pause');
  }
  function pausePodomoro(e) {
    clearInterval(anim);
    play.classList.add('show');
    play.classList.remove('hide');
    pause.classList.add('hide');
    pause.classList.remove('show');
    stop.classList.add('pause');
  }
  function stopPodomoro(e) {
    clearInterval(anim);
    play.classList.add('show');
    play.classList.remove('hide');
    pause.classList.add('hide');
    pause.classList.remove('show');
    stop.classList.remove('show');
    stop.classList.add('hide');
    var sessionTime = document.querySelector('.session__time ').innerHTML;
    time.textContent = sessionTime + ':00';
  }
  //SVG
  //transform second to perimetre
  //path(stroke-dasharray='472', stroke-dashoffset='0.00', \
  //1== 1s donc 472 sec = 7.8 minutes soit 472/60 pour avoir les minutes
  //min * 60 = seconds 
  //donc 10min * 60 on obtient le resutat en seconde et le diametre du 
  //perimetre
  var distancePerPoint = 1;
  var drawFPS = 1000 / 10;
  var orig = document.querySelector('path'),
      length = void 0,
      timer = void 0;

  orig.addEventListener('mouseover', startDrawingPath, true);
  orig.addEventListener('mouseout', stopDrawingPath, true);

  function startDrawingPath() {
    length = 0;
    orig.style.stroke = '#f60';
    timer = setInterval(increaseLength, 1000);
  }

  function increaseLength() {
    var pathLength = orig.getTotalLength();
    length += distancePerPoint;
    //length=0 and path lenght = stroke-dasharray soit 472
    orig.style.strokeDasharray = [length, pathLength].join(' ');
    console.log([length, pathLength].join(' '));
    if (length >= pathLength) clearInterval(timer);
  }

  function stopDrawingPath() {
    clearInterval(timer);
    orig.style.stroke = '';
    orig.style.strokeDasharray = '';
  }

  //let d = 5000
  //new Vivus('my-svg', {
  //duration: d,
  //type: 'delayed',
  //start: 'manual',
  //onReady : (m) => {
  //m.el.setAttribute('height', 'auto');
  //m.el.play()

  //},
  //animTimingFunction: Vivus.EASE
  //})
})(fcc); //END
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJmY2MiLCJkaXNwbGF5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZGlzcGxheUJyZWFrIiwiZ2V0U2Vjb25kcyIsImhvdXIiLCJtaW4iLCJ0ZXh0Q29udGVudCIsInNwbGl0IiwicGFyc2VJbnQiLCJjaXJjdWxhckxvb3AiLCJpbml0IiwiYWN0aW9uIiwiY3VycmVudCIsImFuaW0iLCJ3YXRjaCIsInNlY29uZHMiLCJtaW51dGVzIiwic2V0SW50ZXJ2YWwiLCJjdXJyU2Vjb25kIiwiY2xlYXJJbnRlcnZhbCIsInNlc3Npb25QbHVzIiwic2Vzc2lvbk1pbnVzIiwiYnJlYWtQbHVzIiwiYnJlYWtNaW51cyIsInRpbWUiLCJicmVha1RpbWUiLCJwbGF5Iiwic3RvcCIsInBhdXNlIiwicHJldmlvdXNNaW51cyIsImUiLCJwcmV2IiwicHJldmlvdXNTaWJsaW5nIiwidmFsIiwiY2xhc3NMaXN0IiwiYWRkIiwiY29udGFpbnMiLCJyZW1vdmUiLCJwcmV2ZW50RGVmYXVsdCIsIm5leHRQbHVzIiwibmV4dCIsIm5leHRTaWJsaW5nIiwiYWRkRXZlbnRMaXN0ZW5lciIsInBsYXlQb2RvbW9ybyIsInBhdXNlUG9kb21vcm8iLCJzdG9wUG9kb21vcm8iLCJzZXNzaW9uVGltZSIsImlubmVySFRNTCIsImRpc3RhbmNlUGVyUG9pbnQiLCJkcmF3RlBTIiwib3JpZyIsImxlbmd0aCIsInRpbWVyIiwic3RhcnREcmF3aW5nUGF0aCIsInN0b3BEcmF3aW5nUGF0aCIsInN0eWxlIiwic3Ryb2tlIiwiaW5jcmVhc2VMZW5ndGgiLCJwYXRoTGVuZ3RoIiwiZ2V0VG90YWxMZW5ndGgiLCJzdHJva2VEYXNoYXJyYXkiLCJqb2luIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxNQUFJLGdCQUFSO0FBQ0MsV0FBU0EsR0FBVCxFQUFjO0FBQ2I7QUFDQSxNQUFJQyxVQUFVQyxTQUFTQyxhQUFULENBQXVCLE9B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QjtBQUNBSixZQUFRbkMsWUFBWXdDLGNBQVosRUFBNEIsSUFBNUIsQ0FBUjtBQUNEOztBQUVELFdBQVNBLGNBQVQsR0FBeUI7QUFDdkIsUUFBSUMsYUFBYVIsS0FBS1MsY0FBTCxFQUFqQjtBQUNBUixjQUFVSCxnQkFBVjtBQUNBO0FBQ0FFLFNBQUtLLEtBQUwsQ0FBV0ssZUFBWCxHQUE2QixDQUFDVCxNQUFELEVBQVFPLFVBQVIsRUFBb0JHLElBQXBCLENBQXlCLEdBQXpCLENBQTdCO0FBQ0FDLFlBQVFDLEdBQVIsQ0FBWSxDQUFDWixNQUFELEVBQVFPLFVBQVIsRUFBb0JHLElBQXBCLENBQXlCLEdBQXpCLENBQVo7QUFDQSxRQUFJVixVQUFVTyxVQUFkLEVBQTBCdkMsY0FBY2lDLEtBQWQ7QUFDM0I7O0FBRUQsV0FBU0UsZUFBVCxHQUEwQjtBQUN4Qm5DLGtCQUFjaUMsS0FBZDtBQUNBRixTQUFLSyxLQUFMLENBQVdDLE1BQVgsR0FBb0IsRUFBcEI7QUFDQU4sU0FBS0ssS0FBTCxDQUFXSyxlQUFYLEdBQTZCLEVBQTdCO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTs7QUFFRjtBQUNBO0FBQ0Y7QUFFRCxDQTdMQSxFQTZMQzlELEdBN0xELENBQUQsQyxDQTZMUSIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgZmNjPSdmcmVlIGNvZGUgY2FtcCc7XG4oZnVuY3Rpb24oZmNjKSB7XG4gIC8vdGltZXJcbiAgbGV0IGRpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGltZScpLFxuICBkaXNwbGF5QnJlYWsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnJlYWstdGltZScpOyBcbiAgLy8gZGVmaW5lIGZ1bmN0aW9uIGZvciBzZXRJbnRlcnZhbFxuICBmdW5jdGlvbiBnZXRTZWNvbmRzKGhvdXIpIHtcbiAgICBsZXQgbWluID0gaG91ci50ZXh0Q29udGVudC5zcGxpdCgnOicpXG4gICAgcmV0dXJuIHBhcnNlSW50KG1pblswXSwgMTApKiA2MFxuICB9XG4gIC8vIGRlZmluZSBmdW5jdGlvbiBmb3Igc2V0SW50ZXJ2YWxcbiAgZnVuY3Rpb24gY2lyY3VsYXJMb29wKGluaXQsIG1pbiwgYWN0aW9uKSB7XG4gICAgbGV0IGN1cnJlbnQgPSBpbml0O1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIGFjdGlvbihjdXJyZW50KTtcbiAgICAgIGlmIChjdXJyZW50IC0gMSA9PT0gbWluKSB7XG4gICAgICAgIGN1cnJlbnQgPSBtaW47XG4gICAgICB9IGVsc2UgaWYoY3VycmVudCA+IDApe1xuICAgICAgICBjdXJyZW50LS07XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGxldCBhbmltO1xuICBsZXQgd2F0Y2ggPSAoZGlzcGxheSApID0+IHtcbiAgICBsZXQgc2Vjb25kcywgbWludXRlcztcbiAgICAgIGFuaW0gPSBzZXRJbnRlcnZhbChjaXJjdWxhckxvb3AoZ2V0U2Vjb25kcyhkaXNwbGF5KSAsIDAsIGZ1bmN0aW9uKGN1cnJTZWNvbmQpIHtcbiAgICAgIC8vcGFyc2VJbnQoKSByZXR1cm4gaW50ZWdlciBleCAxMTAvIDYwID0gMS44MzMzMyB3aXRoIHBhcnNlSW50IGl0J3MgMVxuICAgICAgLy9JJ20gdXNpbmcgTWF0aC5mbG9vciwgYm90aCBkbyB0aGUgc2FtZSB3b3JrXG4gICAgICBtaW51dGVzID0gcGFyc2VJbnQoY3VyclNlY29uZCAgLyA2MCwgMTApO1xuICAgICAgLy8gc2Vjb25kcyA9IDEyMnMgLyA2MCA9IDEyMCBhbmQgcmVtYWluIDJcbiAgICAgIHNlY29uZHMgPSBwYXJzZUludChjdXJyU2Vjb25kICAlIDYwLCAxMCk7XG5cbiAgICAgIC8vcHJpbnQgYSAwIGZpcnN0IGlmIG1pbnVzdGUgaXMgbGVzcyB0aGFuIDEwIG1pbnV0ZXMgXG4gICAgICBtaW51dGVzID0gbWludXRlcyA8IDEwID8gXCIwXCIgKyBtaW51dGVzIDogbWludXRlcztcbiAgICAgIHNlY29uZHMgPSBzZWNvbmRzIDwgMTAgPyBcIjBcIiArIHNlY29uZHMgOiBzZWNvbmRzO1xuICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IG1pbnV0ZXMgKyBcIjpcIiArIHNlY29uZHM7XG5cbiAgICAgIGlmIChjdXJyU2Vjb25kID09PSAwKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoYW5pbSlcbiAgICAgIH1cbiAgICB9KSwgMTAwMCk7XG4gIH1cbiAgLy9FTkQgVElNRVJcblxuICAvL0V2ZW50ICsgYW5kIC1cbiAgLy9cbiAgbGV0IHNlc3Npb25QbHVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlc3Npb25fX3BsdXMnKSxcbiAgICBzZXNzaW9uTWludXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2Vzc2lvbl9fbWludXMnKSxcbiAgICBicmVha1BsdXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnJlYWtfX3BsdXMnKSxcbiAgICBicmVha01pbnVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJyZWFrX19taW51cycpLFxuICAgIHRpbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGltZScpLFxuICAgIGJyZWFrVGltZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icmVhay10aW1lJyksXG4gICAgcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5JyksXG4gICAgc3RvcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pY29uLXN0b3AnKSxcbiAgICBwYXVzZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYXVzZScpXG5cbiAgZnVuY3Rpb24gcHJldmlvdXNNaW51cyAoZSkge1xuICAgIGxldCBwcmV2PSB0aGlzLnByZXZpb3VzU2libGluZyxcbiAgICAgIHZhbCA9IHBhcnNlSW50KHByZXYudGV4dENvbnRlbnQsIDEwKVxuICAgIGlmICh2YWwgPiAwKSB7XG4gICAgICBwcmV2LnRleHRDb250ZW50LS1cbiAgICAgIGlmICh2YWwgPT09IDEpIHtcbiAgICAgICAgcHJldi5jbGFzc0xpc3QuYWRkKCdhbGVydCcpXG4gICAgICB9XG4gICAgfVxuICAgIGlmICghdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ2JyZWFrX19taW51cycpKSB7XG4gICAgICB0aW1lLnRleHRDb250ZW50ID0gcHJldi50ZXh0Q29udGVudCArICc6MDAnXG4gICAgICBjbGVhckludGVydmFsKGFuaW0pXG4gICAgfSBlbHNle1xuICAgICAgYnJlYWtUaW1lLnRleHRDb250ZW50ID0gcHJldi50ZXh0Q29udGVudCArICc6MDAnXG5cbiAgICB9IFxuXG4gICAgcGxheS5jbGFzc0xpc3QuYWRkKCdzaG93JylcbiAgICBwbGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKVxuICAgIHBhdXNlLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKVxuICAgIHBhdXNlLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKVxuICAgIHN0b3AuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXG4gICAgc3RvcC5jbGFzc0xpc3QuYWRkKCdoaWRlJylcblxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgfVxuICBmdW5jdGlvbiBuZXh0UGx1cyhlKSB7XG4gICAgbGV0IG5leHQgPSB0aGlzLm5leHRTaWJsaW5nXG4gICAgbGV0IHZhbCA9IHBhcnNlSW50KG5leHQudGV4dENvbnRlbnQsIDEwKVxuICAgIG5leHQudGV4dENvbnRlbnQrK1xuICAgIGlmICh2YWwgPT09IDApIHtcbiAgICAgIG5leHQuY2xhc3NMaXN0LnJlbW92ZSgnYWxlcnQnKVxuICAgIH1cbiAgICBpZiAoIXRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdicmVha19fcGx1cycpKSB7XG4gICAgICB0aW1lLnRleHRDb250ZW50ID0gbmV4dC50ZXh0Q29udGVudCArICc6MDAnXG4gICAgICBjbGVhckludGVydmFsKGFuaW0pXG4gICAgfSBlbHNle1xuICAgICAgYnJlYWtUaW1lLnRleHRDb250ZW50ID0gbmV4dC50ZXh0Q29udGVudCArICc6MDAnXG4gICAgfSBcbiAgICBwbGF5LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKVxuICAgIHBsYXkuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpXG4gICAgcGF1c2UuY2xhc3NMaXN0LmFkZCgnaGlkZScpXG4gICAgcGF1c2UuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXG4gICAgc3RvcC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JylcbiAgICBzdG9wLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKVxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgfVxuXG4gIHNlc3Npb25NaW51cy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycscHJldmlvdXNNaW51cyApO1xuICBzZXNzaW9uUGx1cy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG5leHRQbHVzKTtcbiAgYnJlYWtNaW51cy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycscHJldmlvdXNNaW51cyApO1xuICBicmVha1BsdXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBuZXh0UGx1cyk7XG4gIHBsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5UG9kb21vcm8pO1xuICBwYXVzZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHBhdXNlUG9kb21vcm8pO1xuICBzdG9wLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFBvZG9tb3JvKTtcblxuICBmdW5jdGlvbiBwbGF5UG9kb21vcm8oZSkge1xuICAgIHdhdGNoKGRpc3BsYXkpXG4gICAgcGxheS5jbGFzc0xpc3QuYWRkKCdoaWRlJylcbiAgICBwbGF5LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKVxuICAgIHBhdXNlLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKVxuICAgIHBhdXNlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKVxuICAgIHN0b3AuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpXG4gICAgc3RvcC5jbGFzc0xpc3QuYWRkKCdzaG93JylcbiAgICBzdG9wLmNsYXNzTGlzdC5yZW1vdmUoJ3BhdXNlJylcbiAgfVxuICBmdW5jdGlvbiBwYXVzZVBvZG9tb3JvKGUpIHtcbiAgICBjbGVhckludGVydmFsKGFuaW0pXG4gICAgcGxheS5jbGFzc0xpc3QuYWRkKCdzaG93JylcbiAgICBwbGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKVxuICAgIHBhdXNlLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKVxuICAgIHBhdXNlLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKVxuICAgIHN0b3AuY2xhc3NMaXN0LmFkZCgncGF1c2UnKVxuXG4gIH1cbiAgZnVuY3Rpb24gc3RvcFBvZG9tb3JvKGUpIHtcbiAgICBjbGVhckludGVydmFsKGFuaW0pXG4gICAgcGxheS5jbGFzc0xpc3QuYWRkKCdzaG93JylcbiAgICBwbGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKVxuICAgIHBhdXNlLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKVxuICAgIHBhdXNlLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKVxuICAgIHN0b3AuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXG4gICAgc3RvcC5jbGFzc0xpc3QuYWRkKCdoaWRlJylcbiAgICBsZXQgc2Vzc2lvblRpbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2Vzc2lvbl9fdGltZSAnKS5pbm5lckhUTUxcbiAgICB0aW1lLnRleHRDb250ZW50ID0gc2Vzc2lvblRpbWUgICsgJzowMCdcbiAgfVxuICAvL1NWR1xuICAvL3RyYW5zZm9ybSBzZWNvbmQgdG8gcGVyaW1ldHJlXG4gIC8vcGF0aChzdHJva2UtZGFzaGFycmF5PSc0NzInLCBzdHJva2UtZGFzaG9mZnNldD0nMC4wMCcsIFxcXG4gIC8vMT09IDFzIGRvbmMgNDcyIHNlYyA9IDcuOCBtaW51dGVzIHNvaXQgNDcyLzYwIHBvdXIgYXZvaXIgbGVzIG1pbnV0ZXNcbiAgLy9taW4gKiA2MCA9IHNlY29uZHMgXG4gIC8vZG9uYyAxMG1pbiAqIDYwIG9uIG9idGllbnQgbGUgcmVzdXRhdCBlbiBzZWNvbmRlIGV0IGxlIGRpYW1ldHJlIGR1IFxuICAvL3BlcmltZXRyZVxuICBsZXQgZGlzdGFuY2VQZXJQb2ludCA9IDE7XG4gIGxldCBkcmF3RlBTICAgICAgICAgID0gMTAwMC8xMDtcbiAgbGV0IG9yaWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdwYXRoJyksIGxlbmd0aCwgdGltZXI7XG5cbiAgb3JpZy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLHN0YXJ0RHJhd2luZ1BhdGgsdHJ1ZSk7XG4gIG9yaWcuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCBzdG9wRHJhd2luZ1BhdGgsIHRydWUpO1xuXG4gIGZ1bmN0aW9uIHN0YXJ0RHJhd2luZ1BhdGgoKXtcbiAgICBsZW5ndGggPSAwO1xuICAgIG9yaWcuc3R5bGUuc3Ryb2tlID0gJyNmNjAnO1xuICAgIHRpbWVyID0gc2V0SW50ZXJ2YWwoaW5jcmVhc2VMZW5ndGgsIDEwMDAgKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGluY3JlYXNlTGVuZ3RoKCl7XG4gICAgdmFyIHBhdGhMZW5ndGggPSBvcmlnLmdldFRvdGFsTGVuZ3RoKCk7XG4gICAgbGVuZ3RoICs9IGRpc3RhbmNlUGVyUG9pbnQ7XG4gICAgLy9sZW5ndGg9MCBhbmQgcGF0aCBsZW5naHQgPSBzdHJva2UtZGFzaGFycmF5IHNvaXQgNDcyXG4gICAgb3JpZy5zdHlsZS5zdHJva2VEYXNoYXJyYXkgPSBbbGVuZ3RoLHBhdGhMZW5ndGhdLmpvaW4oJyAnKTtcbiAgICBjb25zb2xlLmxvZyhbbGVuZ3RoLHBhdGhMZW5ndGhdLmpvaW4oJyAnKSk7XG4gICAgaWYgKGxlbmd0aCA+PSBwYXRoTGVuZ3RoKSBjbGVhckludGVydmFsKHRpbWVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3BEcmF3aW5nUGF0aCgpe1xuICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xuICAgIG9yaWcuc3R5bGUuc3Ryb2tlID0gJyc7XG4gICAgb3JpZy5zdHlsZS5zdHJva2VEYXNoYXJyYXkgPSAnJztcbiAgfVxuICBcbiAgLy9sZXQgZCA9IDUwMDBcbiAgLy9uZXcgVml2dXMoJ215LXN2ZycsIHtcbiAgICAvL2R1cmF0aW9uOiBkLFxuICAgIC8vdHlwZTogJ2RlbGF5ZWQnLFxuICAgIC8vc3RhcnQ6ICdtYW51YWwnLFxuICAgIC8vb25SZWFkeSA6IChtKSA9PiB7XG4gICAgICAvL20uZWwuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnYXV0bycpO1xuICAgICAgLy9tLmVsLnBsYXkoKVxuXG4gICAgLy99LFxuICAgIC8vYW5pbVRpbWluZ0Z1bmN0aW9uOiBWaXZ1cy5FQVNFXG4gIC8vfSlcblxufShmY2MpKTsvL0VORFxuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
